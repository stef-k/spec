---
id: T-003
title: GroupLocationsService (members/latest/query)
status: todo
labels: [api]
deps: [T-001]
owner: ""
inputs:
  - Groups.md
outputs: []
timebox: "2h"
---

## Summary
Create `Services/Api/GroupLocationsService` with methods to call:
`GET /api/groups/{groupId}/members`, `POST /api/groups/{groupId}/locations/latest`, and `POST /api/groups/{groupId}/locations/query`. Add DTOs or reuse existing models for binding.

## Acceptance Criteria (measurable)
- [ ] `GetMembersAsync(groupId)` returns `GroupMemberDto[]` and handles 401/403.
- [ ] `GetLatestAsync(groupId, includeUserIds?)` returns `PublicLocationDto[]`.
- [ ] `QueryAsync(groupId, bbox, zoom, date)` returns `{ totalItems, results[] }` and sets per-item `UserId`.

## Steps
- [ ] Read inputs
- [ ] Implement HTTP client with Bearer token, timeouts, JSON options
- [ ] Add request/response models as needed
- [ ] Add logging and error surfaces

## Verification
- Commands:
  - `curl -H "Authorization: Bearer $TOKEN" "$SERVER/api/groups/$GID/members"`
  - `curl -H "Authorization: Bearer $TOKEN" -H "Content-Type: application/json" -d '{"includeUserIds":[]}' "$SERVER/api/groups/$GID/locations/latest"`
  - `curl -H "Authorization: Bearer $TOKEN" -H "Content-Type: application/json" -d '{"minLng":...,"minLat":...,"maxLng":...,"maxLat":...,"zoomLevel":12,"dateType":"day","year":2025,"month":10,"day":21}' "$SERVER/api/groups/$GID/locations/query"`

## Notes
Reuse TimelineService patterns for headers/serialization and logging.

